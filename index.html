<!DOCTYPE html>
<html>
<head>
<meta http-equiv="refresh" content="0;URL=http://eureca.io/">
<title>eureca.io</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap -->
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">

<link href="css/darkstrap-v0.9.0.css" rel="stylesheet" media="screen">
<link href="css/prettify.css" rel="stylesheet" />
<style>
#content {
  margin-top: 50px; }

form.well,
.shift-up {
  margin-top: -19px; }

.span6 > .well {
  margin-top: -19px; }

.ds-margin-top, h2 {
  margin-top: 50px; }

.popovers .popover {
  display: block;
  float: left;
  margin: 20px;
  position: relative;
  width: 260px;
}
.nav li > span
{
display:block;
padding:8px;
}
.right
{
	display:block;
	float:right;
}
</style>

</head>
<body data-spy="scroll" data-target=".navbar">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#top">eureca.io</a>
			<div class="nav-collapse collapse">
				<ul class="nav right">
				<li>
					<span>
						<div class="fb-like" data-href="http://ezelia.github.io/eureca.io/" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>					
					</span>
				</li>
				<li>
					<span>					
						<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://ezelia.github.io/eureca.io/" data-count="horizontal" data-text="eureca.io : a nodejs bidirectional RPC using engine.io or sockjs as transport layer" data-via="Ezelia_" data-related="Ezelia_"></a>
					</span>
				</li>				
				<li>
					<span>
						<div class="g-plusone" data-size="medium" data-href="http://ezelia.github.io/eureca.io/"></div>
					</span>
				</li>	
				<li>
					<span>
						<script type="text/javascript" src="http://www.reddit.com/static/button/button1.js?url=http://ezelia.github.io/eureca.io/"></script>
					</span>
				</li>
				<li><span><iframe id="watch" src="http://ghbtns.com/github-btn.html?user=ezelia&repo=eureca.io&type=watch&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe></span></li>
				<li><span><iframe id="fork" src="http://ghbtns.com/github-btn.html?user=ezelia&repo=eureca.io&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe></span></li>
				</ul>
			</div>
        </div>
      </div>
    </div>



    <a id="anchor-prez"></a><br />

    <div class="container" id="content">


    <div class="hero-unit">
      <h1>eureca.io</h1>
      <p>Author <a href="https://github.com/alaa-eddine">Alaa-eddine K.</a></p>
      <p>a nodejs bidirectional RPC using engine.io or sockjs as transport layer</p>
	  <p>Project page <a href="https://github.com/Ezelia/eureca.io" target="_blank">https://github.com/Ezelia/eureca.io</a></p>
    </div>
    <div class='page-header'>
      <h1>Installation</h1>
    </div>
	
<pre class="prettyprint linenums language-javascript">
npm install eureca.io
</pre>		
	
	<hr />
    <div class='page-header'>
      <h1>Usage</h1>
	  <h2>Base example</h2>
	  <p>
		here we setup a server that expose hello() function.<br />
		we can call this function from a browser client or nodejs client.
	  </p>	  
    </div>
	
    <div class="row">
      <div class="span6">
		<h3 class="well">Server side</h3>
		<div class="well">		
		<h4 class="label label-success"> express server </h4>
<pre class="prettyprint linenums language-javascript">
var express = require('express')
  , app = express(app)
  , server = require('http').createServer(app);
var EurecaServer = require('eureca.io').EurecaServer;

var eurecaServer = new EurecaServer();

eurecaServer.attach(server);


//functions under "exports" namespace will be exposed to client side
eurecaServer.exports.hello = function () {
    console.log('Hello from client');
}
//------------------------------------------

//see browser client side code for index.html content
app.get('/', function (req, res, next) {
    res.sendfile('index.html');
});

server.listen(8000);
</pre>		
		</div>
      </div>
      <div class="span6">
	  <h3 class="well">Client side</h3>
		<div class="well">
		
		
          <ul class="nav nav-tabs">
            <li class="active"><a href="#bclient1" data-toggle="tab">Browser client</a></li>
            <li><a href="#nclient1" data-toggle="tab">Nodejs client</a></li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane active" id="bclient1">
<pre class="prettyprint linenums language-html">
&lt;!doctype html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Engine.io test&lt;/title&gt;
        &lt;script src=&quot;/eureca.js&quot;&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;    
        &lt;script&gt;
            var client = new Eureca.EurecaClient();

            client.ready(function (proxy) {
                proxy.hello();
            });
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre>	
            </div>
            <div class="tab-pane" id="nclient1">
<pre class="prettyprint linenums language-javascript">
var EurecaClient = require('eureca.io').EurecaClient;
var client = new EurecaClient({ uri: 'http://localhost:8000/' });

client.ready(function (proxy) {
    proxy.hello();
});
</pre>	
            </div>
          </div>
		  			  
		</div>
      </div>
    </div>	
	

    <div class='page-header'>
	  <h2>Calling server side functions from client and getting back result</h2>
    </div>

    <div class="row">
      <div class="span6">
		<h3 class="well">Server side</h3>
		<div class="well">		
<pre class="prettyprint linenums language-javascript">
// ... server initialisation
eurecaServer.exports.add = function (a, b) {
    return a+b
}

//... other stuff
</pre>		
		</div>
      </div>
      <div class="span6">
	  <h3 class="well">Client side</h3>
		<div class="well">
		
<pre class="prettyprint linenums language-javascript">
client.ready(function (proxy) {
	//the onReady event is triggered when the remote side finishes
	//executing the called function.
	//returned value is stored in result argument
    proxy.add(10, 5).onReady(function(result) {
		console.log('got result from server, 10+5=', result);
	});
});
</pre>		

		</div>
      </div>
    </div>
	

    <div class='page-header'>
	  <h2>Calling client side functions from server and getting the result back</h2>
	  <p>
	  in this example, client will call foo() function on the server, then the server
	  will call bar() function on the client side<br />
	  
	  <span class="label label-warning">important</span>
	  <b> client side functions need to be allowed first in the server side when creating the server object</b>
	  </p>
    </div>

    <div class="row">
      <div class="span6">
		<h3 class="well">Server side</h3>
		<div class="well">		
<pre class="prettyprint linenums language-javascript">
//we need to allow bar() function first
var eurecaServer = new EurecaServer({allow:['bar']});

// ... server initialisation
eurecaServer.exports.foo = function () {
	//when a server side function is called
	//we can access the client connection
	//throught this.connection
	
    var conn = this.connection;
    var client = eurecaServer.getClient(conn.id);
    console.log('called foo()');
    client.bar();
}

//... other stuff
</pre>		
		</div>
      </div>
      <div class="span6">
	  <h3 class="well">Client side</h3>
		<div class="well">
		
<pre class="prettyprint linenums language-javascript">
client.exports.bar = function ()
{
    console.log('called bar()');
}

client.ready(function (proxy) {
    proxy.foo();
});
</pre>		

		</div>
      </div>
    </div>
	
    <div class='page-header'>
	  <h2>Namespaces</h2>
	  <p>
	  we can expose functions under namespaces if we want to organise them for example
	  </p>
    </div>
    <div class="row">
      <div class="span6">
		<h3 class="well">Server side</h3>
		<div class="well">		
<pre class="prettyprint linenums language-javascript">
// ... server initialisation
eurecaServer.exports.math = {
	add = function (a, b) {
		return a+b
	},	
	sub = function (a, b) {
		return a-b
	}
}

//... other stuff
</pre>		
		</div>
      </div>
      <div class="span6">
	  <h3 class="well">Client side</h3>
		<div class="well">
		
<pre class="prettyprint linenums language-javascript">
client.ready(function (proxy) {
	proxy.math.add(10, 5).onReady(function(result) {
		console.log('got result from server, 10+5=', result);
	});

	proxy.math.sub(10, 5).onReady(function(result) {
		console.log('got result from server, 10-5=', result);
	});
	
});
</pre>		

		</div>
      </div>
    </div>
	
	<hr />
    
	<h2>Events</h2>
	<h3>Server side events</h3>
    <p>EurecaServer exposes four events</p>
	<ul>
	<li><b>onConnect</b> triggered when a new client connects to the server.</li>
	<li><b>onMessage</b> triggered each time a messages is sent from client to server, this can be useful to debug or watch how eureca.io works.</li>
	<li><b>onDisconnect</b> triggered when a client disconnect.</li>
	<li><b>onError</b> if something goes wrong with underlying connection this event will be triggered</li>
	</ul>
<pre class="prettyprint linenums language-javascript">
var EurecaServer = require('eureca.io').EurecaServer;
var eurecaServer = new EurecaServer();

eurecaServer.onConnect(function (connection) {
    
    console.log('new Client', connection.id);
    var client = eurecaServer.getClient(connection.id);
    
	//if we defined helloclient() function in the client side
	//we can call it like this
    client.helloclient();
    
});

eurecaServer.onMessage(function (msg) {
    console.log('RECV', msg);
});


eurecaServer.onDisconnect(function (connection) {    
    console.log('client %s disconnected', connection.id);
});

eurecaServer.onError(function (e) {    
    console.log('an error occured', e);
});
</pre>		
	
	<h3>Client side events</h3>
    <p>EurecaClient exposes seven events</p>
	<ul>
	<li><b>ready</b> this is a special event, triggered one the client is ready to call server side functions.</li>
	<li><b>onConnect</b> triggered when a the client successfully open a connection to the server.</li>
	<li><b>onMessage</b> triggered each time a messages is received from the server</li>
	<li><b>onDisconnect</b> triggered when the client lost connection. this will cause the client process to terminate.</li>
	<li><b>onConnectionLost</b> when the client lost connection, it will try to reconnect to the server, this event indicate that a question is lost and that an attempt to reconnect will be triggered.</li>
	<li><b>onConnectionRetry</b> triggered many times after "onConnectionLost" ... if the connection cannot be re-estabilished the client stop trying and triggers "onDisconnect" event.</li>
	<li><b>onError</b> if something goes wrong with underlying connection this event will be triggered</li>
	</ul>	
<pre class="prettyprint linenums language-javascript">
var EurecaClient = require('eureca.io').EurecaClient;
var client = new EurecaClient({ uri: 'http://localhost:8000/' });

//remote parameter contains the proxy able to call server side functions
client.ready(function(remote) {
	remote.helloServer();
});

client.onConnect(function (connection) {
    console.log('Incomming connection', connection.id);
});

client.onMessage(function (data) {
    console.log('Received data', data);
});

client.onError(function (e) {
    console.log('error', e);
});

client.onConnectionLost(function () {
    console.log('connection lost ... will try to reconnect');
});

client.onConnectionRetry(function (socket) {
    console.log('retrying ...');

});

client.onDisconnect(function (socket) {
    console.log('Client disconnected ', connection.id);

});
</pre>	
	
	
	
    <div class='page-header'>
	  <h2>TODO</h2>
	  <p>This documentation is not complete, will be updated with more examples</p>
    </div>	
	
  </div> <!-- /container -->
  
  
  
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script src="js/prettify.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script>
    $(document).ready(function() {
	/*
		$("pre.language-javascript").snippet("javascript", {style:"pablo"});
		$("pre.language-html").snippet("html", {style:"pablo"});
		$('pre.prettyprint').css({'overflow':'auto', 'padding':'0px', 'padding-top':'20px'});
		$('.linenums li').each(function(i){
			var text = $(this).html();
			$(this).html(text.replace(/\s/g, '&nbsp;'));
			$(this).html(text.replace(/\t/g, '&nbsp;&nbsp;&nbsp;'));
			$(this).css({'white-space':'nowrap', 'padding-left':'0px'})
		});			
	*/
		/* syntax highlight */
		
		prettyPrint();	  
		$('.linenums li span').each(function(i){
			var text = $(this).html();
			text = text.replace(/\s/g, '&nbsp;');
			text.replace(/\t/g, '&nbsp;&nbsp;&nbsp;');
			
			$(this).html(text);
			$(this).css({'white-space':'nowrap'});
		});	
		
		/*************************/
		
		/* tabs 
		$('.ctabs a').click(function (e) {
		e.preventDefault();
		$(this).tab('show');
		})
		/*************************/
		

      $("#style-toggle").click(function (e) {
        e.preventDefault();

        // Toggle <link> url
        $link = $("link#darkstrap-link");
        var href = $link.attr("href")
        var css_url = 
          href.length > 0 ?  "" : "css/darkstrap.css"
        $link.attr("href", css_url);

        // Toggle button text
        $this = $(this);
        var text = $this.text() == "Toggle Darkstrap" ?
          "Toggle Bootstrap" : "Toggle Darkstrap";
        $this.text(text);
      });
    });
  </script>

  <script type="text/javascript">
    $(function () {
      $("#tooltip-example").tooltip();
    });
  </script>


  <script type="text/javascript">
    $(function () {
      $("#myCarousel").carousel();
    });
  </script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/fr_FR/all.js#xfbml=1&appId=258181120968938";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>  
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>  
<script type="text/javascript">
    (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-35225306-6', 'eureca.io');
  ga('send', 'pageview');

</script>
</body>
</html>
